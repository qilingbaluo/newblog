{"remainingRequest":"D:\\dewebblog\\dwebhtml\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\dewebblog\\dwebhtml\\src\\views\\AddArticle.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\dewebblog\\dwebhtml\\src\\views\\AddArticle.vue","mtime":1608527388739},{"path":"D:\\dewebblog\\dwebhtml\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\dewebblog\\dwebhtml\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\dewebblog\\dwebhtml\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\dewebblog\\dwebhtml\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCAkIGZyb20gJ2pxdWVyeSc7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCBRcyBmcm9tICdxcycKZXhwb3J0IGRlZmF1bHQgewogICAgZGF0YSgpIHsKCiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgYXJ0aWNsZV9pbmZvOiB7CiAgICAgICAgICAgICAgICB0aXRsZTogJycsCiAgICAgICAgICAgICAgICBkZXNjcmliZTogJycsCiAgICAgICAgICAgICAgICBjb250ZW50czogJycsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGNvdmVyX2ltZzogJycsCiAgICAgICAgICAgIGNvdmVyX2xpc3Q6IFtdCiAgICAgICAgfQogICAgfSwKICAgIG1vdW50ZWQoKSB7CiAgICAgICAgdGhpcy5zdW1tZXJub3RlKCkKCiAgICB9LAogICAgbWV0aG9kczogewogICAgICAgIHN1Ym1pdEFydGljbGUoKSB7CiAgICAgICAgICAgIGxldCBhcnRpY2xlX2RhdGEgPSB7CiAgICAgICAgICAgICAgICB0aXRsZTogdGhpcy5hcnRpY2xlX2luZm8udGl0bGUsCiAgICAgICAgICAgICAgICBkZXNjcmliZTogdGhpcy5hcnRpY2xlX2luZm8uZGVzY3JpYmUsCiAgICAgICAgICAgICAgICBjb250ZW50OiB0aGlzLmFydGljbGVfaW5mby5jb250ZW50cywKICAgICAgICAgICAgICAgIGNvdmVyOiB0aGlzLmNvdmVyX2ltZywKICAgICAgICAgICAgICAgIHRva2VuOiB0aGlzLiRzdG9yZS5nZXR0ZXJzLmlzbm90VXNlcmxvZ2luCiAgICAgICAgICAgIH0KICAgICAgICAgICAgYXhpb3MucG9zdCgnaHR0cHM6Ly93d3cud2FuZ2Jsb2cuY2x1Yi9hcGkvYWRkLWFydGljbGUvJywgUXMuc3RyaW5naWZ5KGFydGljbGVfZGF0YSkpCiAgICAgICAgICAgICAgICAudGhlbihyZXMgPT4gewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcykKICAgICAgICAgICAgICAgICAgICBpZiAocmVzLmRhdGEgPT0gJ25vdGl0bGUnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGFsZXJ0KCfmlofnq6DmoIfpopjkuI3og73kuLrnqbonKQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhID09ICdub2xvZ2luJykgewogICAgICAgICAgICAgICAgICAgICAgICBhbGVydCgn55So5oi35L+h5oGv6ZSZ6K+vJykKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGlmIChyZXMuZGF0YSA9PSAnb2snKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAuY2F0Y2goZXJyID0+IHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7CiAgICAgICAgICAgICAgICB9KQogICAgICAgIH0sCgogICAgICAgIHN1bW1lcm5vdGUoKSB7CiAgICAgICAgICAgIGxldCBzZWxmID0gdGhpcwogICAgICAgICAgICAkKCcjc3VtbWVybm90ZScpLnN1bW1lcm5vdGUoewogICAgICAgICAgICAgICAgd2lkdGg6ICcxMDAlJywKICAgICAgICAgICAgICAgIGhlaWdodDogNTAwLAogICAgICAgICAgICAgICAgbGFuZzogJ3poLUNOJywKICAgICAgICAgICAgICAgIGNhbGxiYWNrczogewogICAgICAgICAgICAgICAgICAgIC8v5b2T6L6T5YWlCiAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2UoY29udGVudHMpIHsKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hcnRpY2xlX2luZm8uY29udGVudHMgPSBjb250ZW50cwoKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIC8v5pys5Zyw5Zu+54mH5LiK5LygCiAgICAgICAgICAgICAgICAgICAgb25JbWFnZVVwbG9hZChmaWxlcykgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhmaWxlcykKICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGltZyA9IGZpbGVzWzBdOwogICAgICAgICAgICAgICAgICAgICAgICBsZXQgaW1nRGF0YSA9IG5ldyBGaWxlUmVhZGVyKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGltZ0RhdGEucmVhZEFzRGF0YVVSTChpbWcpOwogICAgICAgICAgICAgICAgICAgICAgICAvLyAgY29uc29sZS5sb2coaW1nRGF0YSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGltZ0RhdGEub25sb2FkID0gZnVuY3Rpb24oKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyAgY29uc29sZS5sb2coaW1nRGF0YS5yZXN1bHQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/mj5LlhaXlm77niYfmnKzouqsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbWdub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGltZ25vZGUuc3JjID0gaW1nRGF0YS5yZXN1bHQKICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoJyNzdW1tZXJub3RlJykuc3VtbWVybm90ZSgnaW5zZXJ0Tm9kZScsIGltZ25vZGUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy/mjqjlhaXlsIHpnaLlvoXpgInmi6kKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY292ZXJfbGlzdC5wdXNoKGltZ0RhdGEucmVzdWx0KTsKICAgICAgICAgICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgIC8v6L+c56iL5Zu+54mH5LiK5LygCiAgICAgICAgICAgICAgICAgICAgb25JbWFnZUxpbmtJbnNlcnQodXJsKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIC8vICBjb25zb2xlLmxvZyh1cmwpCiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbWdub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJykKICAgICAgICAgICAgICAgICAgICAgICAgaW1nbm9kZS5zcmMgPSB1cmwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vICBjb25zb2xlLmxvZyhpbWdub2RlKQogICAgICAgICAgICAgICAgICAgICAgICAkKCcjc3VtbWVybm90ZScpLnN1bW1lcm5vdGUoJ2luc2VydE5vZGUnLCBpbWdub2RlKQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNvdmVyX2xpc3QucHVzaCh1cmwpOwogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgLy/liKDpmaTlqpLkvZPmlofku7YKICAgICAgICAgICAgICAgICAgICBvbk1lZGlhRGVsZXRlKHRhcmdldCkgewogICAgICAgICAgICAgICAgICAgICAgICAvLyAgY29uc29sZS5sb2codGFyZ2V0KQogICAgICAgICAgICAgICAgICAgICAgICBsZXQgaW1nRGF0YSA9IHRhcmdldFswXS5zcmMKICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coaW1nRGF0YSkKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxmLmNvdmVyX2xpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLmNvdmVyX2xpc3RbaV0gPT0gaW1nRGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuY292ZXJfbGlzdC5zcGxpY2UoaSwgMSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICAgLy/pgInmi6nlsIHpnaIKICAgICAgICBjaG9vc2VDb3ZlcihpbWcpIHsKICAgICAgICAgICAgdGhpcy5jb3Zlcl9pbWcgPSBpbWcKICAgICAgICB9LAogICAgfSwKfTsK"},{"version":3,"sources":["AddArticle.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgDA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AddArticle.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n    <div id=\"add-article\">\r\n        <el-row :gutter=\"10\">\r\n            <el-col :xs='24' :lg=\"8\">\r\n                <div class=\"dweb\">\r\n                    <el-form label-width=\"80px\" :model=\"article_info\">\r\n                        <el-form-item label=\"文章标题\">\r\n                            <el-input v-model=\"article_info.title\"></el-input>\r\n                        </el-form-item>\r\n                        <el-form-item label=\"描述\">\r\n                            <el-input  type=\"textarea\" :rows=\"4\" v-model=\"article_info.describe\"></el-input>\r\n                        </el-form-item>\r\n                    </el-form>\r\n                </div>\r\n            </el-col>\r\n            <el-col :xs='24' :lg=\"16\">\r\n                <div class=\"dweb\">\r\n                    <div v-for= \"(img,index) in cover_list\" :key=\"index\">\r\n                        <el-image\r\n                        v-if=\"img == cover_img\"\r\n                        class=\"cover\"\r\n                        style=\"width: 150px; height: 150px\"\r\n                        :src=\"img\"\r\n                        :fit=\"'cover'\"\r\n                        @click=\"chooseCover(img)\"\r\n                        ></el-image>\r\n                        <el-image\r\n                        v-else\r\n                        class=\"\"\r\n                        style=\"width: 150px; height: 150px\"\r\n                        :src=\"img\"\r\n                        :fit=\"'cover'\"\r\n                        @click=\"chooseCover(img)\"\r\n                        ></el-image>\r\n                    </div>\r\n                    <el-button @click=\"submitArticle\" type=\"success\" round>保存文章</el-button>\r\n                </div>\r\n            </el-col>\r\n            <el-col :xs='24' :lg=\"24\">\r\n                <div class=\"dweb\">\r\n                    <div id=\"summernote\"></div>\r\n                </div>\r\n            </el-col>\r\n\r\n        </el-row>\r\n    </div>\r\n</template>\r\n<script>\r\n    import $ from 'jquery';\r\n    import axios from 'axios';\r\n    import Qs from 'qs'\r\n    export default {\r\n        data() {\r\n\r\n            return {\r\n                article_info: {\r\n                    title: '',\r\n                    describe: '',\r\n                    contents: '',\r\n                },\r\n                cover_img: '',\r\n                cover_list: []\r\n            }\r\n        },\r\n        mounted() {\r\n            this.summernote()\r\n\r\n        },\r\n        methods: {\r\n            submitArticle() {\r\n                let article_data = {\r\n                    title: this.article_info.title,\r\n                    describe: this.article_info.describe,\r\n                    content: this.article_info.contents,\r\n                    cover: this.cover_img,\r\n                    token: this.$store.getters.isnotUserlogin\r\n                }\r\n                axios.post('https://www.wangblog.club/api/add-article/', Qs.stringify(article_data))\r\n                    .then(res => {\r\n                        console.log(res)\r\n                        if (res.data == 'notitle') {\r\n                            alert('文章标题不能为空')\r\n                            return\r\n                        }\r\n                        if (res.data == 'nologin') {\r\n                            alert('用户信息错误')\r\n                            return\r\n                        }\r\n                        if (res.data == 'ok') {\r\n                            window.location.reload()\r\n                        }\r\n                        \r\n                    })\r\n                    .catch(err => {\r\n                        console.error(err);\r\n                    })\r\n            },\r\n\r\n            summernote() {\r\n                let self = this\r\n                $('#summernote').summernote({\r\n                    width: '100%',\r\n                    height: 500,\r\n                    lang: 'zh-CN',\r\n                    callbacks: {\r\n                        //当输入\r\n                        onChange(contents) {\r\n                            self.article_info.contents = contents\r\n\r\n                        },\r\n                        //本地图片上传\r\n                        onImageUpload(files) {\r\n                            // console.log(files)\r\n                            let img = files[0];\r\n                            let imgData = new FileReader();\r\n                            imgData.readAsDataURL(img);\r\n                            //  console.log(imgData);\r\n                            imgData.onload = function() {\r\n                                //  console.log(imgData.result);\r\n                                //插入图片本身\r\n                                let imgnode = document.createElement('img')\r\n                                imgnode.src = imgData.result\r\n                                $('#summernote').summernote('insertNode', imgnode)\r\n                                    //推入封面待选择\r\n                                self.cover_list.push(imgData.result);\r\n                            };\r\n                        },\r\n                        //远程图片上传\r\n                        onImageLinkInsert(url) {\r\n                            //  console.log(url)\r\n                            let imgnode = document.createElement('img')\r\n                            imgnode.src = url\r\n                                //  console.log(imgnode)\r\n                            $('#summernote').summernote('insertNode', imgnode)\r\n                            self.cover_list.push(url);\r\n                        },\r\n                        //删除媒体文件\r\n                        onMediaDelete(target) {\r\n                            //  console.log(target)\r\n                            let imgData = target[0].src\r\n                            console.log(imgData)\r\n                            for (let i = 0; i < self.cover_list.length; i++) {\r\n                                if (self.cover_list[i] == imgData) {\r\n                                    self.cover_list.splice(i, 1)\r\n                                }\r\n\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n            },\r\n            //选择封面\r\n            chooseCover(img) {\r\n                this.cover_img = img\r\n            },\r\n        },\r\n    };\r\n</script>\r\n<style scoped>\r\n    .dweb {\r\n        /* height: 200px; */\r\n        min-height: 200px;\r\n        padding: 20px 20px;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n    }\r\n    \r\n    .dweb .el-image:hover {\r\n        border: 5px solid #df1717;\r\n    }\r\n    \r\n    .dweb .el-image.cover {\r\n        border: 5px solid #df1717;\r\n    }\r\n    \r\n    .dweb .el-button {\r\n        position: fixed;\r\n        right: 20px;\r\n        margin-top: 250px;\r\n        z-index: 1001;\r\n    }\r\n    \r\n    .el-form-item {\r\n        margin-top: 22px;\r\n    }\r\n</style>"]}]}