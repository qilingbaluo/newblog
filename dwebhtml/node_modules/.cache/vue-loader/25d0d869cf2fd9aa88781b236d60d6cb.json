{"remainingRequest":"D:\\dewebblog\\dwebhtml\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\dewebblog\\dwebhtml\\src\\views\\Article.vue?vue&type=style&index=0&id=82768ea8&scoped=true&lang=css&","dependencies":[{"path":"D:\\dewebblog\\dwebhtml\\src\\views\\Article.vue","mtime":1608527398662},{"path":"D:\\dewebblog\\dwebhtml\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\dewebblog\\dwebhtml\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\dewebblog\\dwebhtml\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\dewebblog\\dwebhtml\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\dewebblog\\dwebhtml\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouYm9keS5kd2ViIHsKICAgIHBhZGRpbmc6IDEwcHggMTBweDsKfQoKLmJvZHkuZHdlYiAuZHdlYiB7CiAgICBwYWRkaW5nOiAxMHB4IDEwcHg7CiAgICBjb2xvcjogI2ZmZmZmZjsKICAgIGZvbnQtc2l6ZTogMTRweDsKICAgIGZvbnQtc3R5bGU6IGl0YWxpYzsKfQoKLmxpa2UtYnRuIHsKICAgIHRleHQtYWxpZ246IGNlbnRlcjsKCn0KCi5saWtlLWJ0biBpIHsKICAgIGZvbnQtc2l6ZTogMzBweDsKICAgIGN1cnNvcjogcG9pbnRlcjsKfQoKLmJvZHkuZHdlYiAucGluZ2x1bi1pdGVtIHsKICAgIGNvbG9yOiAjZmZmZmZmOwogICAgZm9udC1zaXplOiAyMHB4Owp9Cg=="},{"version":3,"sources":["Article.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmRA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"Article.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n    <div>\r\n        <BreadMenu :page_name=\"article_data.title\" :lanmu=\"article_data.lanmu\"></BreadMenu>\r\n        <!-- 文章内容 -->\r\n        <el-row>\r\n            <el-col :Xs=\"24\" :lg=\"16\">\r\n                <div class=\"body dweb\">\r\n                    <div class=\"header\">\r\n                        {{ article_data.title }}\r\n                    </div>\r\n                </div>\r\n                <div class=\"body dweb\">\r\n                    <div class=\"dweb\">\r\n                        {{ article_data.describe }}\r\n                    </div>\r\n                </div>\r\n                <div class=\"body dweb\">\r\n                    <div class=\"article-content\" v-html=\"article_data.content\">\r\n                    </div>\r\n                    <div class=\"clear\">\r\n                    </div>\r\n                </div>\r\n                <div class=\"body dweb\">\r\n                    <el-button v-if=\"article_data.pre_id==0\" @click=\"toOtherPage(article_data.pre_id)\" type=\"info\"\r\n                        plain>上一篇</el-button>\r\n                    <el-button v-else @click=\"toOtherPage(article_data.pre_id)\" type=\"success\" plain>上一篇</el-button>\r\n                    <el-button v-if=\"article_data.next_id==0\" @click=\"toOtherPage(article_data.next_id)\" type=\"info\"\r\n                        plain>下一篇</el-button>\r\n                    <el-button v-else @click=\"toOtherPage(article_data.next_id)\" type=\"success\" plain>下一篇</el-button>\r\n                </div>\r\n            </el-col>\r\n            <el-col :xs=\"24\" :lg=\"8\">\r\n                <div class=\"body dweb\">\r\n                    <el-image :src=\"article_data.cover\" :fit=\"'cover'\">\r\n\r\n                    </el-image>\r\n                    <div class=\"body dweb like-btn\">\r\n                        <!-- 点赞收藏打赏 -->\r\n                        <el-row>\r\n                            <!-- 点赞 -->\r\n                            <el-col :span=\"8\">\r\n                                <i v-if=\"user_article_info.like\" class=\"iconfont icon-dianzan\" style=\"color: #fc5959;\"\r\n                                    @click=\"toLike()\"></i>\r\n                                <i v-else class=\"iconfont icon-dianzan\" @click=\"toLike()\"></i>\r\n                            </el-col>\r\n                            <!-- 收藏 -->\r\n                            <el-col :span=\"8\">\r\n                                <i v-if=\"user_article_info.favor\" class=\"iconfont icon-shoucang\" style=\"color: #ffc815;\"\r\n                                    @click=\"toFavor()\"></i>\r\n                                <i v-else class=\"iconfont icon-shoucang\" @click=\"toFavor()\"></i>\r\n                            </el-col>\r\n                            <!-- 打赏 -->\r\n                            <el-col :span=\"8\">\r\n                                <i @click=\"toDashang()\" v-if=\"user_article_info.dashang\" class=\"iconfont icon-dashang\"\r\n                                    style=\"color: #ffc815;\"></i>\r\n                                <i @click=\"toDashang()\" v-else class=\"iconfont icon-dashang\"></i>\r\n                            </el-col>\r\n                        </el-row>\r\n                    </div>\r\n                    <!-- 评论列表 -->\r\n                    <div class=\"body dweb\">\r\n                        <div v-for=\"(item,index) in pinglun_data\" :key=\"index\" class=\"body dweb pinglun-item\">\r\n                            {{ item.nickName }} 说\r\n                            <el-divider></el-divider>\r\n                            {{ item.text }}\r\n                        </div>\r\n                    </div>\r\n                    <!-- 分页器 -->\r\n                    <div class=\"dweb\" style=\"margin-top: 7px;\">\r\n                        <el-pagination small :pager-count=\"5\" background layout=\"prev, pager, next\"\r\n                            :total=\"pinglu_total\" :page-size=\"pinglun_pageSize\" @current-change=\"pinglun_currentChange\">\r\n                        </el-pagination>\r\n                    </div>\r\n                    <!-- 评论 -->\r\n                    <div class=\"body dweb\">\r\n                        <el-input type=\"textarea\" :maxlength=\"120\" :rows=\"2\" placeholder=\"请输入内容\" v-model=\"new_pinglun\">\r\n                        </el-input>\r\n                        <el-button @click=\"saveNewPinglun()\" type=\"success\">发表评论</el-button>\r\n                    </div>\r\n                    <div>\r\n                        <a id=\"payLink\" href=\"https://www.alipay.com/\" target=\"_blank\"></a>\r\n                    </div>\r\n                </div>\r\n            </el-col>\r\n        </el-row>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import BreadMenu from '../components/BreadMenu'\r\n    import axios from 'axios'\r\n    import Qs from 'qs'\r\n    export default {\r\n        data() {\r\n            return {\r\n                article_id: this.$route.query.id,\r\n                article_data: {},\r\n                // 评论\r\n                new_pinglun: \"\",\r\n                pinglu_total: 100,\r\n                pinglun_pageSize: 4,\r\n                pinglun_data: [],\r\n                user_article_info: {},\r\n            }\r\n        },\r\n        components: {\r\n            BreadMenu\r\n        },\r\n        watch: {\r\n            $route(to) {\r\n                this.article_id = to.query.id\r\n                this.getArticleData(to.query.id)\r\n                this.getAllPinglun(1, this.pinglun_pageSize)\r\n                this.getUserArticleInfo()\r\n            }\r\n        },\r\n        mounted() {\r\n            this.getArticleData(this.article_id)\r\n            this.getAllPinglun(1, this.pinglun_pageSize)\r\n            this.getUserArticleInfo()\r\n        },\r\n        methods: {\r\n            // 点赞\r\n            toLike() {\r\n                axios({\r\n                    url: \"https://www.wangblog.club/api/article-like/\",\r\n                    method: \"post\",\r\n                    data: Qs.stringify({\r\n                        token: this.$store.getters.isnotUserlogin,\r\n                        article_id: this.article_id,\r\n                    }),\r\n                }).then((res) => {\r\n                    if (res.data == 'nologin') {\r\n                        alert('请登录')\r\n                        return\r\n                    }\r\n                    if (res.data == \"ok\") {\r\n                        this.getUserArticleInfo()\r\n                    }\r\n\r\n                })\r\n            },\r\n            // 收藏\r\n            toFavor() {\r\n                axios({\r\n                    url: \"https://www.wangblog.club/api/article-favor/\",\r\n                    method: \"post\",\r\n                    data: Qs.stringify({\r\n                        token: this.$store.getters.isnotUserlogin,\r\n                        article_id: this.article_id,\r\n                    }),\r\n                }).then((res) => {\r\n                    if (res.data == 'nologin') {\r\n                        alert('请登录')\r\n                        return\r\n                    }\r\n                    if (res.data == \"ok\") {\r\n                        this.getUserArticleInfo()\r\n                    }\r\n                })\r\n            },\r\n            // 打赏\r\n            toDashang() {\r\n                axios({\r\n                    method: 'post',\r\n                    url: \"https://www.wangblog.club/api/get-alipay-url/\",\r\n                    data: Qs.stringify({\r\n                        token: this.$store.getters.isnotUserlogin,\r\n                        article_id: this.article_id\r\n                    })\r\n                }).then((res) => {\r\n                    let link = document.getElementById('payLink')\r\n                    link.herf = res.data.pay_link\r\n                    link.click()\r\n                    if (confirm('支付完成了吗？')) {\r\n                        console.log('ok')\r\n                    }\r\n                })\r\n\r\n            },\r\n            // 获取互动信息\r\n            getUserArticleInfo() {\r\n                let token = this.$store.getters.isnotUserlogin;\r\n                if (token) {\r\n                    axios({\r\n                        url: \"https://www.wangblog.club/api/user-article-info/\",\r\n                        method: \"post\",\r\n                        data: Qs.stringify({\r\n                            token: token,\r\n                            article_id: this.article_id,\r\n                        }),\r\n                    }).then((res) => {\r\n                        console.log(res.data)\r\n                        this.user_article_info = res.data;\r\n                    });\r\n                }\r\n            },\r\n            // 获取评论数据\r\n            getAllPinglun(page, pagesize) {\r\n                axios({\r\n                    method: 'get',\r\n                    url: \"https://www.wangblog.club/api/pinglun/\",\r\n                    params: {\r\n                        page,\r\n                        pagesize,\r\n                        article_id: this.article_id,\r\n\r\n                    }\r\n                }).then((res) => {\r\n                    this.pinglun_data = res.data.data\r\n                    // console.log(res.data.data)\r\n                    this.pinglu_total = res.data.total\r\n                })\r\n            },\r\n            // 发表评论\r\n            saveNewPinglun() {\r\n                if (this.new_pinglun.length == 0) {\r\n                    alert('请输入评论')\r\n                    return\r\n                }\r\n                axios({\r\n                    method: 'post',\r\n                    url: \"https://www.wangblog.club/api/pinglun/\",\r\n                    data: Qs.stringify({\r\n                        token: this.$store.getters.isnotUserlogin,\r\n                        article_id: this.article_id,\r\n                        text: this.new_pinglun\r\n                    })\r\n                }).then((res) => {\r\n                    console.log(res)\r\n                    if (res.data == 'onlogin') {\r\n                        alert('用户登录信息错误')\r\n                        return;\r\n                    }\r\n                    if (res.data == 'noperm') {\r\n                        alert('权限不足')\r\n                        return\r\n                    }\r\n                    if (res.data == 'ok') {\r\n                        this.getAllPinglun(1, this.pinglun_pageSize)\r\n                    }\r\n                })\r\n            },\r\n            // 评论翻页\r\n            pinglun_currentChange(page) {\r\n                this.getAllPinglun(page, this.pinglun_pageSize);\r\n            },\r\n            // 跳转文章上一页下一页\r\n            toOtherPage(id) {\r\n                if (id == 0) {\r\n                    alert('没有了')\r\n                    return\r\n                }\r\n                this.$router.push({ path: '/article', query: { id: id } })\r\n            },\r\n            // 查看文章\r\n            getArticleData(id) {\r\n                console.log(id)\r\n                axios({\r\n                    method: 'get',\r\n                    url: \"https://www.wangblog.club/api/article-data\",\r\n                    //使用get方法时用params\r\n                    params: {\r\n                        article_id: id\r\n                    }\r\n                }).then((res) => {\r\n                    // console.log(res.data)\r\n                    this.article_data = res.data\r\n\r\n                })\r\n            }\r\n        },\r\n    }\r\n</script>\r\n<style scoped>\r\n    .body.dweb {\r\n        padding: 10px 10px;\r\n    }\r\n\r\n    .body.dweb .dweb {\r\n        padding: 10px 10px;\r\n        color: #ffffff;\r\n        font-size: 14px;\r\n        font-style: italic;\r\n    }\r\n\r\n    .like-btn {\r\n        text-align: center;\r\n\r\n    }\r\n\r\n    .like-btn i {\r\n        font-size: 30px;\r\n        cursor: pointer;\r\n    }\r\n\r\n    .body.dweb .pinglun-item {\r\n        color: #ffffff;\r\n        font-size: 20px;\r\n    }\r\n</style>"]}]}